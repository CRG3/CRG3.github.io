<div ng-controller="SiteCtrl as sites">
  <div class="row">
    <div class="col-sm-3" id="sidebar">

      <ul class="nav nav-stacked">
        <li>
          <input ng-model="query" type="text" placeholder="Search"/>
        </li>
        <li>
            <p>Filter by Group</p>
            <select class="selectpicker" ng-model='search.variable' ng-options=" feature.variable as feature.variable for feature in sites.projects | unique:'variable' | orderBy:'variable'" fix>
              <option value="" selected="selected">-- All Groups --</option>
            </select>
          <li>
            <li>
              <div class="form-group">
                <button type="button" class="btn btn-grey" ng-click='clearSelections()'>Clear Selections</button>
              </div>
            </li>
      </ul>
    </div>
    <div class="col-sm-9" id="mainCol">
    <div ng-controller="MapCtrl as map" >
      <div style="height:300px;">
        <leaflet center="map.center" geojson="sites.geojson" events="map.events" width="100%" height="100%"></leaflet>
      </div>
    </div>

    <div style="padding: 20px"></div>

    <div ng-controller="TableCtrl as table">
          <table border="1" style="width:100%">
            <tr>
              <th><a href="" ng-click="orderByField = 'name'; reverse=!reverse">Name</a></th>
              <th><a href="" ng-click="orderByField = 'variable'; reverse=!reverse">Variable</a></th>
              <th><a href="" ng-click="orderByField = 'year'; reverse=!reverse">Year</a></th>
            </tr>
            <tr ng-repeat="feature in sites.projects | orderBy:orderByField:reverse | filter:query" ng-class="{'selected':$index == table.selectedRow}" ng-click="table.setClickedRow($index)">
              <td>{{feature.name}}</td>
              <td>{{feature.variable}}</td>
              <td>{{feature.year}}</td>
            </tr>
          </table>
        </div>
      </div>
    </div>
  </div>
